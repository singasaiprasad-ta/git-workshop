name: Python Packaging
on:
    # Triggers the workflow on push or pull request events but only for the $default-branch 
  push:
    branches: test/11/pytest

  pull_request:
    branches: main

    # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:  

jobs:
   build_test_package:
     name: build_test_package
     runs-on: "ubuntu-latest"
     defaults:
       run:
         shell: bash -el {0}
     steps:     
       - uses: actions/checkout@v4
       - name: Install tree
         run: |
              sudo apt install tree
       - name: Display directory tree(before build)
         run: |   
             tree    
       - name: Build the package
         run: |
             rm -rf build/ dist/ mypackage.egg-info
             pip install wheel
             python setup.py sdist bdist_wheel
       - name: Display directory tree(after build)    
         run: |
             tree        
       - name: Install the package
         run: |
           which python
           which pip
           pip uninstall mypackage
           pip install dist/*.whl
           python --version
           python -m pip show mypackage
           pip list
          #  ls /usr/share/miniconda3/envs/test/lib/python3.13/site-packages/mypackage
       - name: Run tests
         run: |
           pip install pytest
           pip show mypackage
           pytest ./tests/test_build.py    
           tree   
      





